<!DOCTYPE html>
<html lang="pt-br">

<head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta name="keywords" content="telecall, comunicação, internet, telefonia, celular, plano" />
    <title> Site oficial - Registro Telecall</title>
    <link rel="shortcut icon" href="../IMG/icontelecall.png" type="image/x-icon" />
    <link rel="shortcut icon" href="../IMG/icontelecall.png" type="image/x-icon" />
    <link rel="stylesheet" href="../CSS/register.css" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" />
    <script src="text/javascript"></script>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.1/jquery.min.js"></script>
    <script src="https://rawgit.com/RobinHerbots/jquery.inputmask/3.x/dist/jquery.inputmask.bundle.js"></script>
    <script src="https://cdn.rawgit.com/igorescobar/jQuery-Mask-Plugin/master/src/jquery.mask.js"></script>
</head>

<body>
    <header class="cabeçalho_registro">
        <a href="../HTML/home.html"><img src="../IMG/logotelecall.png" alt="logo da telecall" /></a>
    </header>
    <form method="post" autocomplete="on" id="form">
        <h1>Cadastro Telecall</h1>

        <div>
            <label for="nome" class="lbl-tittle">Nome Completo</label>
            <input type="text" id="nome" class="inputs required" name="Nome" placeholder="Digite aqui seu nome"
                maxlength="60" autofocus oninput="nameValidate()">
            <span class="span-required">Nome deve ter no mínimo 15 caracteres. </span>
            <span class="span-right">Nome Válido ✓</span>
        </div>

        <div>
            <label for="dataNasc" class="lbl-tittle">Data de nascimento</label>
            <input type="date" id="dataNasc" class="inputs required">
            <span class="span-required">Preencha sua data de nascimento neste campo. </span>
            <span class="span-right">Data Válida ✓</span>
        </div>

        <div>
            <label class="lbl-tittle">Sexo</label> <br />

            <input type="radio" id="rad_m" name="sexo" value="Masculino">
            <label for="rad_m">Masculino</label>

            <input type="radio" id="rad_f" name="sexo" value="Feminino">
            <label for="rad_f">Feminino</label>

            <input type="radio" id="rad_o" name="sexo" value="Outros">
            <label for="rad_o">Outros</label>
        </div>

        <div>
            <label for="cpf" class="lbl-tittle">CPF</label> <br />
            <input type="text" id="cpf" class="inputs required" name="cpf" placeholder="Somente números"
                autocomplete="off" maxlength="14" oninput="cpfValidate()">
            <span class="span-required">Insira um CPF válido. </span>
            <span class="span-right">CPF Válido ✓</span>
        </div>

        <div>
            <label for="celular" class="lbl-tittle">Celular (com DDD)</label>
            <input type="text" placeholder="(xx) xxxxxxxxx" id="celular" class="inputs required" name="celular"
                maxlength="11" oninput="number1Validate()">
            <span class="span-required">O número precisa conter o DDD com algum número válido. </span>
            <span class="span-right">Celular Válido ✓</span>
        </div>

        <div>
            <label for="telefone" class="lbl-tittle">Telefone fixo</label>
            <input type="text" placeholder="(xx) xxxxxxxxx" id="telefone" class="inputs required" name="telefone"
                maxlength="10" oninput="number2Validate()">
            <span class="span-required">O número precisa conter o DDD com algum número válido. </span>
            <span class="span-right">Telefone Válido ✓</span>
        </div>

        <div>
            <label for="endereco" class="lbl-tittle">Endereço</label>
            <input type="text" placeholder="Endereço Completo" id="endereco" class="inputs required" name="endereço"
                maxlength="50" oninput="enderecoValidate()">
            <span class="span-required">O campo endereço precisa ser preenchido. </span>
            <span class="span-right">Endereço Válido ✓</span>
        </div>

        <div>
            <label for="login" class="lbl-tittle">Nome login</label>
            <input type="text" id="login" class="inputs required" name="login" placeholder="Digite seu nome de login"
                minlength="6" oninput="loginValidate()">
            <span class="span-required">Este campo Login deve possuir 6 caracteres alfabéticos. </span>
            <span class="span-right">Login Válido ✓</span>
        </div>

        <div>
            <label for="senha" class="lbl-tittle">Senha</label>
            <input type="password" id="senha" class="inputs required" name="senha" placeholder="Digite sua senha"
                autocomplete="off" oninput="senhaValidate()">
            <span class="span-required">Este campo deve possuir 8 caracteres alfabéticos. </span>
            <span class="span-right">De acordo ✓</span>
        </div>

        <div>
            <label for="conf_senha" class="lbl-tittle">Confirme sua senha</label>
            <input type="password" id="conf_senha" class="inputs required" name="senha" autocomplete="off"
                placeholder="Digite sua senha novamente" oninput="senhaComparar()">
            <span class="span-required">Este campo precisa corresponder com o campo senha. </span>
            <span class="span-right">✓</span>
        </div>

        <button onclick="validaDados()" type="button">Crie sua Conta Telecall</button>

        <div style="text-align: center;"><span id="span_cad">Cadastrando Usuário...</span></div>

        <p>Já tem uma conta? <a href="login.html">Login</a></p>
    </form>


    <!--JavaScript com as validaçõs dos campos do register-->
    <script>
        let nome = document.querySelector('#nome');
        let login = document.querySelector('#login')
        let senha = document.querySelector('#senha');
        let conf_senha = document.querySelector('#conf_senha');


        const form = document.getElementById('form');
        const lbl = document.querySelectorAll('label');
        const campos = document.querySelectorAll('.required');
        const spans = document.querySelectorAll('.span-required');
        const spanright = document.querySelectorAll('.span-right');
        const spancad = document.querySelector('#span_cad')
        const cpf = document.querySelector('#cpf');
        const dataNasc = document.querySelector('#dataNasc');
        const celular = document.querySelector("#celular");
        const telefone = document.querySelector("#telefone");
        const emailRegex = /^\w+([-+.']\w+)*@\w+([-.]\w+)*\.\w+([-.]\w+)*$/;


        function setError(index) {
            campos[index].style.border = '2px solid #e63636';
            spanright[index].style.display = '';
            spans[index].style.display = 'block';
        }

        function removeError(index) {
            campos[index].style.border = '2px solid #42BB33';
            spans[index].style.display = '';
            spanright[index].style.display = 'block';
        }


        function nameValidate() {
            if (campos[0].value.length < 15) {
                setError(0);
            }
            else {
                removeError(0);
            }
        }

        function dataValidate() {
            if (campos[1].value == '') {
                setError(1);
            }
            else {
                removeError(1);
            }
        }

        function cpfValidate() {
            if (campos[2].value.length != 14) {
                setError(2);
            }
            else {
                removeError(2);
            }
        }

        function number1Validate() {
            if (campos[3].value.length != 15) {
                setError(3);
            }
            else {
                removeError(3);
            }
        }

        function number2Validate() {
            if (campos[4].value.length != 14) {
                setError(4);
            }
            else {
                removeError(4);
            }
        }

        function enderecoValidate() {
            if (campos[5].value.length < 8) {
                setError(5);
            }
            else {
                removeError(5);
            }
        }

        function loginValidate() {
            if (campos[6].value.length < 6) {
                setError(6);
            }
            else {
                removeError(6);
            }
        }

        function senhaValidate() {
            if (campos[7].value.length < 8) {
                setError(7);
            }
            else {
                removeError(7);
                senhaComparar();
            }
        }

        function senhaComparar() {
            if (campos[7].value == campos[8].value && campos[8].value.length >= 8) {
                removeError(8);
            }
            else {
                setError(8);
            }
        }

        cpf.addEventListener('keypress', () => {
            let cpflength = cpf.value.length;

            if (cpflength == 3 || cpflength == 7) {
                cpf.value += '.'
            }
            else if (cpflength == 11) {
                cpf.value += '-'
            }
        })

        function cadastrar() {
            if (nameValidate && loginValidate && senhaValidate && senhaComparar) {
                let listaUser = JSON.parse(localStorage.getItem('listaUser') || '[]')

                listaUser.push(
                    {
                        nomeCad: nome.value,
                        LoginCad: login.value,
                        senhaCad: senha.value
                    }
                )

                localStorage.setItem('listaUser', JSON.stringify(listaUser))

                spancad.setAttribute('style', 'display:block')

                setTimeout(() => {
                    window.location.href = 'file:///C:/Users/Pichau/Desktop/Login%20-%20Telecall%20(novo)/HTML/login.html'
                }, 2000);
            }
        }

        function validaDados() {
            if (nome.value == '' && nome.value.length < 15) {
                setError(0);
                campos[0].focus();
            }
            else if (dataNasc.value == '') {
                setError(1);
                campos[1].focus();
            }
            else if (cpf.value.length != 14) {
                setError(2);
                campos[2].focus();
            }
            else if (campos[3].value.length != 15) {
                setError(3);
                campos[3].focus();
            }
            else if (campos[4].value.length != 14) {
                setError(4);
                campos[4].focus();
            }
            else if (campos[5].value.length < 8) {
                setError(5);
                campos[5].focus();
            }
            else if (campos[6].value.length < 6) {
                setError(6);
                campos[6].focus();
            }
            else if (campos[7].value.length < 8) {
                setError(7);
                campos[7].focus();
            }
            else if (campos[8].value == '' && campos[8] != campos[7]) {
                setError(8);
                campos[8].focus();
            }
            else {
                cadastrar();
            }
        }

    </script>

    <!--JQuery das validações dos campos tel-->
    <script>
        $(document).ready(function () {
            $('body').on('focus', '#celular', function () {
                var maskBehavior = function (val) {
                    return val.replace(/\D/g, '').length === 11 ? '(00) 00000-0000' : '(00) 0000-00009';
                },
                    options = {
                        onKeyPress: function (val, e, field, options) {
                            field.mask(maskBehavior.apply({}, arguments), options);

                            if (field[0].value.length >= 14) {
                                var val = field[0].value.replace(/\D/g, '');
                                if (/\d\d(\d)\1{7,8}/.test(val)) {
                                    field[0].value = '';
                                    alert('Telefone Invalido');
                                }
                            }
                        }
                    };
                $(this).mask(maskBehavior, options);
            });
        });


        $(document).ready(function () {
            $('body').on('focus', '#telefone', function () {
                var maskBehavior = function (val) {
                    return val.replace(/\D/g, '').length === 11 ? '(00) 0000-0000' : '(00) 0000-0000';
                },
                    options = {
                        onKeyPress: function (val, e, field, options) {
                            field.mask(maskBehavior.apply({}, arguments), options);

                            if (field[0].value.length >= 14) {
                                var val = field[0].value.replace(/\D/g, '');
                                if (/\d\d(\d)\1{7,8}/.test(val)) {
                                    field[0].value = '';
                                    alert('Telefone Invalido');
                                }
                            }
                        }
                    };
                $(this).mask(maskBehavior, options);
            });
        });


        $(function () {
            $("#cpf").inputmask({
                mask: "999.999.999-99"
            });
        });
    </script>

</body>

</html>